<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; object-src 'none'; base-uri 'none'; frame-ancestors 'none'"
    />
    <meta
      http-equiv="X-Content-Security-Policy"
      content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; object-src 'none'; base-uri 'none'; frame-ancestors 'none'"
    />
    <title>InkTrace Viewer</title>
  </head>
  <body>
    <h1>InkTrace Viewer</h1>

    <section class="panel form-panel">
      <div class="form-row">
        <label for="historySelect">歷史紀錄（含 token）</label>
        <select id="historySelect">
          <option value="">請選擇</option>
        </select>
      </div>
      <div class="form-row">
        <label for="repoUrl">GitHub Repo URL</label>
        <input id="repoUrl" type="text" placeholder="https://github.com/owner/repo.git" />
      </div>
      <div class="form-row">
        <label for="branch">Branch</label>
        <input id="branch" type="text" value="main" />
      </div>
      <div class="form-row">
        <label for="token">Token（私有 repo 可填）</label>
        <input id="token" type="password" placeholder="ghp_..." />
      </div>
      <div class="form-row">
        <label for="destination">下載資料夾</label>
        <div class="inline-group">
          <input id="destination" type="text" readonly />
          <button id="pickFolderBtn" type="button">選擇資料夾</button>
        </div>
      </div>
      <div class="inline-group">
        <button id="cloneBtn" type="button">開始抓取</button>
        <button id="openRepoBtn" type="button">開啟已下載 Repo</button>
        <button id="cancelBtn" type="button" disabled>取消</button>
      </div>
      <div id="status" class="status">尚未開始。</div>
      <pre id="logs" class="logs"></pre>
    </section>

    <section class="panel viewer-panel">
      <div class="svg-list-pane">
        <h2>SVG 清單</h2>
        <input id="svgSearch" type="text" placeholder="搜尋 SVG 檔名或路徑" />
        <ul id="svgList"></ul>
      </div>
      <div class="svg-preview-pane">
        <h2 id="previewTitle">預覽</h2>
        <div id="previewContainer" class="preview-empty">請先選擇 SVG 檔案。</div>
      </div>
    </section>
  </body>

  <style>
    :root {
      color-scheme: light dark;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }

    body {
      margin: 16px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .panel {
      border: 1px solid #8884;
      border-radius: 8px;
      padding: 12px;
    }

    .form-panel {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .form-row {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .inline-group {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    input,
    select,
    button {
      padding: 8px;
      font-size: 14px;
    }

    input[type='text'],
    input[type='password'],
    select {
      width: 100%;
      box-sizing: border-box;
    }

    .status {
      font-size: 14px;
    }

    .logs {
      margin: 0;
      max-height: 140px;
      overflow: auto;
      border: 1px solid #8884;
      border-radius: 6px;
      padding: 8px;
      font-size: 12px;
      white-space: pre-wrap;
      word-break: break-word;
    }

    .viewer-panel {
      display: grid;
      grid-template-columns: 340px 1fr;
      min-height: 420px;
      gap: 12px;
    }

    .svg-list-pane,
    .svg-preview-pane {
      display: flex;
      flex-direction: column;
      min-height: 0;
    }

    .svg-list-pane h2,
    .svg-preview-pane h2 {
      margin: 0 0 8px;
      font-size: 16px;
    }

    #svgSearch {
      margin-bottom: 8px;
    }

    #svgList {
      list-style: none;
      padding: 0;
      margin: 0;
      border: 1px solid #8884;
      border-radius: 6px;
      overflow: auto;
      flex: 1;
    }

    #svgList li {
      border-bottom: 1px solid #8883;
    }

    #svgList li:last-child {
      border-bottom: none;
    }

    #svgList button {
      width: 100%;
      text-align: left;
      background: none;
      border: none;
      padding: 8px 10px;
      cursor: pointer;
    }

    #svgList button:hover,
    #svgList button.selected {
      background: #4d7cff33;
    }

    #previewContainer {
      border: 1px solid #8884;
      border-radius: 6px;
      flex: 1;
      overflow: auto;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 0;
      padding: 10px;
    }

    #previewContainer img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }

    .preview-empty {
      font-size: 14px;
      opacity: 0.8;
    }
  </style>

  <script src="./renderer.js"></script>
</html>